From 9262a14f86328ae4c8cd9d69b12288962cffe93d Mon Sep 17 00:00:00 2001
From: Johannes Wiesboeck <johannes.wiesboeck@aisec.fraunhofer.de>
Date: Wed, 27 Aug 2025 12:32:41 +0200
Subject: [PATCH] include/configs/tqmlx2160a: Secure Boot for MC firmware and
 DPC

Signed-off-by: Johannes Wiesboeck <johannes.wiesboeck@aisec.fraunhofer.de>
---
 include/configs/tqmlx2160a.h | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/include/configs/tqmlx2160a.h b/include/configs/tqmlx2160a.h
index 7bdffeb8898..3c3d6c10679 100644
--- a/include/configs/tqmlx2160a.h
+++ b/include/configs/tqmlx2160a.h
@@ -220,6 +220,11 @@ unsigned long get_board_ddr_clk(void);
 #define SD_MC_INIT_CMD				\
 	"load mmc ${mmcdev_sdhc}:${bootpart} 0x80a00000 ${mc_file};"\
 	"load mmc ${mmcdev_sdhc}:${bootpart} 0x80e00000 ${dpc_file};"\
+	"env exists secureboot && "                     \
+	"load mmc ${mmcdev_sdhc}:${bootpart} 0x80640000 ${mc_file}.hdr &&"         \
+	"load mmc ${mmcdev_sdhc}:${bootpart} 0x80680000 ${dpc_file}.hdr &&"                \
+	"esbc_validate 0x80640000 && "                  \
+	"esbc_validate 0x80680000 ;" \
 	"fsl_mc start mc 0x80a00000 0x80e00000\0"
 
 #define SD2_MC_INIT_CMD				\
